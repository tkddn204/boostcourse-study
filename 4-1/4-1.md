# 프로젝트 4-1. 예약관리시스템: 상세페이지-백엔드

Created: Jul 22, 2019 6:37 PM
tags: 부스트코스,웹프로그래밍

## 서론

  프로젝트 3 이후 부스트코스 에이스 1기에 지원하여 첫 번째 프로젝트(4-1)를 끝내고, 글을 쓰게 되었습니다. 저는 이전에 안드로이드와 Nodejs, 파이썬으로 작업을 해왔었습니다. 하지만 자바로 웹을 개발하는 것은 이번 부스트코스를 통해 처음 접했습니다. Nodejs를 해본 덕분에 어느 정도 웹 개발을 할 때 돌아가는 방식은 대충 알았지만 **스프링**을 하다보니 저는 더욱 무지하다(...)는 것을 알게 되었습니다. 스프링은 사용자가 직접 관리를 하는 것이 아니라 프레임워크가 관리를 거의 다 해주는 부분이 많아서 개발자 입장에서 편리하며, 관리에 용이하다고 느껴졌습니다. 그 외에도 다른 부분들(이전에는 웹 개발을 할 때 이런식으로 개발을 했구나, 이런식의 방법이 있구나 등)을 배울 수 있어 부스트코스 프로젝트를 진행하면서 많은 도움이 되었습니다.

---

## 이번 프로젝트는?

  기획서, 명세서, Swagger에 따르면 백엔드 부분에서는, 다음 URL 하나를 추가하면 됩니다.

    **GET =>** /api/product/{displayInfoId}

  와! 프로젝트 3에서는 기반 작업 + URL 2개라서 힘들었는데, 하나만 추가하면 된다니.. 너무 기뻤습니다.

**그런데,** 하나의 REST 요청에 이만큼의 정보를 담아야 했습니다.

![음... 많다](./images/swaggerInfo)

  생각을 해보니, 하나의 요청에 `Comment`, `CommentImage`, `DisplayInfo`, `DisplayInfoImage`, `ProductImage`, `ProductPrice` 의 **6개**의 DTO를 담아야 했고, 총 **6번**의 쿼리를 보내야 했습니다...

이 때 생각이 딱 들더군요.. **노가다가 시작된다**는 생각이.....(ㅠㅠ)

  노가다를 하면서 많은 고민들이 있었는데, 그 중 *네 가지의 고민*과 고민을 통해 제가 배운 것들을 말씀드리겠습니다.

## 고민 1 - 어디서 합치는가?

  가공할 게 많은 쿼리라도 하나의 쿼리 또는 하나의 DTO로 뭉쳐서 보내면 되지 않나? 라는 생각이 들었습니다. 하지만 제가 아는 자바는 하나에 넣는 것을 싫어하고, 여러의 객체로 분리하는 ~~객체 분리 집착 언어~~로 알고 있습니다. 그래서 제가 생각한 게 틀릴 거란 예감을 하면서 인터넷에서 비슷한 경우를 찾아보았습니다([스택오버플로우 링크](https://stackoverflow.com/questions/30746894/dtos-with-different-granularity)). 역시 스택오버플로우의 답변에서는 하나의 DTO가 아니라, 여러개의 DTO를 만든 뒤 하나의 DTO에 넣어서 보내는 방식을 추천했습니다.

---

> **배운 것 1**
  하나의 DTO는 하나의 일만 하도록 하자.

---

  그리고 다른 사이트에서, DAO에서 가공한 정보들은 **서비스**에서 합치는 게 좋다는 것도 배웠습니다. 아직 명확하게 DAO-서비스-컨트롤러 간에 하는 일이 명확하게 머릿속에 들어오지 않아서, 저는 컨트롤러(...)에서 합치는 것을 진행했습니다만 리뷰어님의 말씀에 따르면 컨트롤러 부분에서 나누기보다, 서비스에서 합쳐야 한다고 하셨습니다. ~~다시 리팩토링하러 가겠습니다~~

---

> **배운 것 2**
  DAO가 가공한 데이터들은 Service쪽에서 합치자.

---

  인터넷을 다시 둘러보고, 이해한 DAO-서비스-컨트롤러는 다음과 같습니다.

- **DAO** : 데이터베이스 작업(CRUD)을 JDBC를 통해 처리하는 객체
- **서비스** : DAO에서 처리한 작업을 가공하는 객체
- **컨트롤러** : 사용자가 요청한 작업을 서비스를 통해 처리하여 응답하는 객체

## 고민 2 - 서버에서 처리하는가 vs 클라이언트에서 처리하는가

  일단 고민 1이 해결되어서 어찌저찌 많은 DTO와 DAO의 지옥에서 벗어났다고 생각했더니! 다른 고민이 등장했습니다. 프로젝트 3의 메인 페이지에서는 서버에서 처리(컨트롤러에서 보내는 방식)했지만, 너무나 많은 서비스들을 한 번 더 불러서 만드는 것은 경제성이 낮다고 생각했고, 이미 만든 REST를 뭐 또 다시 서버에서 부르나 싶어서 클라이언트에서 AJAX로 부르도록 처리했습니다.

## 고민 3 - 기타 이미지 REST를 따로 만들어야하는가?

  분명 REST 스펙에는 URL 하나만 있었지만, 기획서를 보니, ETC 이미지를 불러오는 URL을 하나 더 만들어서 AJAX로 불러야만 했습니다... ~~속았어~~ 만들지 않고 처리하는 방법이 있는가 생각해봤지만, 아무리 생각해도 하나 더 만들어야 했습니다...ㅠㅠ 다음 REST URL은 제가 임의로 만들었습니다.

    **GET =>** /api/product/{displayInfoId}/etc

  이 URL과 AJAX를 통해 ETC 이미지들을 불러왔습니다.

---

## 결론

  이번 프로젝트4-1에서의 개발과 고민, 노력~~노가다~~을 통해 다시 DTO, DAO-서비스-컨트롤러에 대한 개념을 정립하고, 스프링에 익숙해지는 시간을 가질 수 있었습니다. 다음 4-2에서는 또다른 지옥이 펼쳐질 예정입니다. 읽어주셔서 감사합니다.

#부스트코스 #웹프로그래밍